<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ECT: @Reconstructor_2D/Reconstructor_2D.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>@Reconstructor_2D/Reconstructor_2D.m</h1><a href="_reconstructor__2_d_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 %&gt; @file <a class="code" href="class_reconstructor__2_d.html" title="Class used to reconstruct image.">Reconstructor_2D</a>.m
<a name="l00002"></a>00002 %&gt; @brief Class used to reconstruct image. 
<a name="l00003"></a>00003 % ======================================================================
<a name="l00004"></a>00004 %&gt; @brief Class used to reconstruct image. Can read capacitance data from file. Display
<a name="l00005"></a>00005 %&gt; reconstruction results.
<a name="l00006"></a>00006 % ectsim - Electrical Capacitance Tomography - Image Reconstruction Toolbox
<a name="l00007"></a>00007 % ======================================================================
<a name="l00008"></a><a class="code" href="class_reconstructor__2_d.html#cc8495a7ff254bc8ca37354356abd9fe">00008</a> classdef <a class="code" href="class_reconstructor__2_d.html" title="Class used to reconstruct image.">Reconstructor_2D</a> &lt; <a class="code" href="class_reconstructor.html" title="This is abstract class. Basic properties and methods use to reconstruct image.">Reconstructor</a>
<a name="l00009"></a>00009     
<a name="l00010"></a>00010     properties (GetAccess = public)  
<a name="l00011"></a>00011         %&gt; Electrical field <span class="keywordtype">object</span> with main phantom
<a name="l00012"></a>00012         Ef_pha;
<a name="l00013"></a>00013         %&gt; Electrical field <span class="keywordtype">object</span> with uniform minimal permittivity phantom
<a name="l00014"></a><a class="code" href="class_reconstructor__2_d.html#568608b0d409f03c0034d335ef027f62">00014</a>         Ef_min;
<a name="l00015"></a>00015         %&gt; Electrical field <span class="keywordtype">object</span> with uniform maximal permittivity phantom
<a name="l00016"></a><a class="code" href="class_reconstructor__2_d.html#3993d3dc0801660de65e7c290bff1916">00016</a>         Ef_max;
<a name="l00017"></a>00017         %&gt; Electrical field <span class="keywordtype">object</span> with uniform average permittivity phantom
<a name="l00018"></a><a class="code" href="class_reconstructor__2_d.html#8d957dc90148971045e3d1778c2b1058">00018</a>         Ef_avg;
<a name="l00019"></a>00019         
<a name="l00020"></a><a class="code" href="class_reconstructor__2_d.html#99eb2e4e03272a4984a26c03d6970ca1">00020</a>         %&gt; vector of permittivity distribution - start solution
<a name="l00021"></a>00021         Ep_0; 
<a name="l00022"></a>00022         %&gt; matrix of permittivity distribution - start solution (reshape Ep_0)
<a name="l00023"></a><a class="code" href="class_reconstructor__2_d.html#879e5617177a94642b134a280b40e06d">00023</a>         Ep_0_map;        
<a name="l00024"></a>00024         %&gt; vector of sensitivity distribution - start solution
<a name="l00025"></a><a class="code" href="class_reconstructor__2_d.html#c0e6b5732d84e7e6f0d2bddfdea5e145">00025</a>         S_0;
<a name="l00026"></a>00026         %&gt; matrix of sensitivity distribution - start solution (reshape S_0)
<a name="l00027"></a><a class="code" href="class_reconstructor__2_d.html#479d4384c9e86bfa7d7c88d4a5b94066">00027</a>         S_0_map;
<a name="l00028"></a>00028         
<a name="l00029"></a><a class="code" href="class_reconstructor__2_d.html#87d131ab8d9c7ed51ec0123711b63eb9">00029</a>         %&gt; vector of eps maps <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> each algorithm iteration        
<a name="l00030"></a>00030         Ep_maps_iter; 
<a name="l00031"></a>00031         %&gt; number of maps <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> Ep_maps_iter (usualy start solution + numiter)
<a name="l00032"></a><a class="code" href="class_reconstructor__2_d.html#23fa76e69b2e6ca5ad9067e95934911f">00032</a>         maps_number         
<a name="l00033"></a>00033         
<a name="l00034"></a><a class="code" href="class_reconstructor__2_d.html#bd82618121a4f7b96c6361680077c080">00034</a>         %&gt; capacitance measurement from electrical field pha <span class="keywordtype">object</span>
<a name="l00035"></a>00035         Cm   
<a name="l00036"></a>00036         %&gt; recalculated capacitance <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> each iteration
<a name="l00037"></a><a class="code" href="class_reconstructor__2_d.html#f15c4e8e76b19dde1854faff5a5e16f4">00037</a>         Cr_iter; 
<a name="l00038"></a>00038         
<a name="l00039"></a><a class="code" href="class_reconstructor__2_d.html#b07a1a8c17972fe7ac60c66bce216e71">00039</a>         % Algorithm parameters
<a name="l00040"></a>00040         %&gt; algorithm name 
<a name="l00041"></a>00041         method
<a name="l00042"></a>00042         %&gt; number of iteration
<a name="l00043"></a><a class="code" href="class_reconstructor__2_d.html#bed946c62f140eb7ff2ac742e6ad9497">00043</a>         numiter
<a name="l00044"></a>00044         %&gt; stop algorithm when difference between current and previous permittivity distribution is less then stop_delta
<a name="l00045"></a><a class="code" href="class_reconstructor__2_d.html#f2d1bdfb2f5c57184421db4027ebf181">00045</a>         stop_delta
<a name="l00046"></a>00046         %&gt; update method 'auto' or 'modulo' 
<a name="l00047"></a><a class="code" href="class_reconstructor__2_d.html#7960fa5c743ccc9e4ed4a5d87bf1d643">00047</a>         update_method
<a name="l00048"></a>00048         %&gt; recalculate sensitivity matrix when mod(numiter,iter_mod)==0 (update_method must be 'modulo')
<a name="l00049"></a><a class="code" href="class_reconstructor__2_d.html#91488e8c3550f2f38b0f8ba0a3746cc1">00049</a>         iter_mod
<a name="l00050"></a>00050         %&gt; recalculate sensitivity matrix when difference between previous and current capacitances is less than update_delta
<a name="l00051"></a><a class="code" href="class_reconstructor__2_d.html#f708a2ba2b8d42a7b729b1c55ee7dd48">00051</a>         update_delta
<a name="l00052"></a>00052         %&gt; current argorithm step
<a name="l00053"></a><a class="code" href="class_reconstructor__2_d.html#5f65618cd18e864c7daca65fbbdf28b7">00053</a>         alpha
<a name="l00054"></a>00054         %&gt; previous argorithm step
<a name="l00055"></a><a class="code" href="class_reconstructor__2_d.html#62197192f0fbf4e0675eb37be1c4c175">00055</a>         alpha_ 
<a name="l00056"></a>00056         %&gt; limit of step (alpha) value
<a name="l00057"></a><a class="code" href="class_reconstructor__2_d.html#d5a779e59654adc7bfa1a725b127fa1a">00057</a>         alphalimit
<a name="l00058"></a>00058         %&gt; enable regularization - L-curve disable - manual 
<a name="l00059"></a><a class="code" href="class_reconstructor__2_d.html#10a3210ee7f0ba6f3d8c7127e488ba68">00059</a>         regular
<a name="l00060"></a>00060         %&gt; Thikonov regularization factor, regular property must be 'manual'
<a name="l00061"></a><a class="code" href="class_reconstructor__2_d.html#2621ec19315edc42c5a535d69e83f132">00061</a>         u
<a name="l00062"></a>00062         %&gt; struct with algorithm parameters
<a name="l00063"></a><a class="code" href="class_reconstructor__2_d.html#6277e2a7446059985dc9bcf0a4ac1a8f">00063</a>         param;
<a name="l00064"></a>00064         
<a name="l00065"></a><a class="code" href="class_reconstructor__2_d.html#51f20d6b1b54a2eee3be0e8adc96a0ae">00065</a>         %&gt; number of last itration
<a name="l00066"></a>00066         current_iter; 
<a name="l00067"></a>00067         %&gt; struct with capacitance, permittivity and sensitivity errors
<a name="l00068"></a><a class="code" href="class_reconstructor__2_d.html#438d999c15c0c725d26d165bfca96254">00068</a>         errors
<a name="l00069"></a>00069     end
<a name="l00070"></a><a class="code" href="class_reconstructor__2_d.html#cc42076253600be964e110149b458971">00070</a>     
<a name="l00071"></a>00071     properties (GetAccess = private)  
<a name="l00072"></a>00072         
<a name="l00073"></a>00073         %&gt; side size of matrix        
<a name="l00074"></a>00074         matrix_size;
<a name="l00075"></a>00075         %&gt; vector of permittivity distribution of phantom
<a name="l00076"></a><a class="code" href="class_reconstructor__2_d.html#323fd4ba6bec854101439af4184386a5">00076</a>         Ep_Pha;   
<a name="l00077"></a>00077         %&gt; matrix of permittivity distribution of phantom
<a name="l00078"></a><a class="code" href="class_reconstructor__2_d.html#7863d387824dee28f01b5048bac88746">00078</a>         Ep_Pha_map;
<a name="l00079"></a>00079         %&gt; vector of sensitivity distribution of phantom
<a name="l00080"></a><a class="code" href="class_reconstructor__2_d.html#7352a6e4aca1ad7cf16b0a3d86630ee2">00080</a>         S_Pha;
<a name="l00081"></a>00081         %&gt; matrix of sensitivity distribution of phantom
<a name="l00082"></a><a class="code" href="class_reconstructor__2_d.html#f18c3f0ced6bc0ae3e8b8b6c8d152c46">00082</a>         S_Pha_map;        
<a name="l00083"></a>00083         %&gt; vector of permittivity distribution from current iteration
<a name="l00084"></a><a class="code" href="class_reconstructor__2_d.html#75aba9407781733e5f6a3a87e4dbe454">00084</a>         Ep;
<a name="l00085"></a>00085         %&gt; matrix of permittivity distribution from current iteration
<a name="l00086"></a><a class="code" href="class_reconstructor__2_d.html#b086c01455120c2847d5bcf6eabb0b27">00086</a>         Ep_map; 
<a name="l00087"></a>00087         %&gt; vector of permittivity distribution from previous iteration
<a name="l00088"></a><a class="code" href="class_reconstructor__2_d.html#d777f5678924d93aed856a3deb1131ed">00088</a>         Ep_;      
<a name="l00089"></a>00089         %&gt; matrix of permittivity distribution from previous iteration
<a name="l00090"></a><a class="code" href="class_reconstructor__2_d.html#dbd60a60204b2cda2dbc8c614a2ded96">00090</a>         Ep_map_; 
<a name="l00091"></a>00091         %&gt; vector of sensitivity distribution from current iteration
<a name="l00092"></a><a class="code" href="class_reconstructor__2_d.html#e6826702e95010dab3fc253d2e3fc18d">00092</a>         S;  
<a name="l00093"></a>00093         %&gt; matrix of sensitivity distribution from current iteration
<a name="l00094"></a><a class="code" href="class_reconstructor__2_d.html#d53aeb78abc83a52ab8982f5c82a3d5b">00094</a>         S_map; 
<a name="l00095"></a>00095                        
<a name="l00096"></a><a class="code" href="class_reconstructor__2_d.html#1fc6b269e70790a6782162b8cf08a862">00096</a>         %&gt; vector of minimal permittivity distribution 
<a name="l00097"></a>00097         Ep_min;
<a name="l00098"></a>00098         %&gt; matrix of minimal permittivity distribution 
<a name="l00099"></a><a class="code" href="class_reconstructor__2_d.html#92a4429182472e0bb7da8539a9af9306">00099</a>         Ep_min_map;
<a name="l00100"></a>00100         %&gt; vector of maximal permittivity distribution 
<a name="l00101"></a><a class="code" href="class_reconstructor__2_d.html#f9b7369ceee8b6d15d3888e02fc48b1a">00101</a>         Ep_max;
<a name="l00102"></a>00102         %&gt; matrix of maximal permittivity distribution 
<a name="l00103"></a><a class="code" href="class_reconstructor__2_d.html#43e8bd79a307341ce2841939211807e0">00103</a>         Ep_max_map;
<a name="l00104"></a>00104         
<a name="l00105"></a><a class="code" href="class_reconstructor__2_d.html#834d13bc242b8c549ed9b15db3310263">00105</a>         %&gt; capacitance normalized measurement
<a name="l00106"></a>00106         Cm_n;                                    
<a name="l00107"></a>00107         %&gt; capacitance measurement from electrical field max <span class="keywordtype">object</span>
<a name="l00108"></a><a class="code" href="class_reconstructor__2_d.html#cd7a80187dffe4e29e055d0a594dbbc8">00108</a>         C_max;
<a name="l00109"></a>00109         %&gt; capacitance measurement from electrical field min <span class="keywordtype">object</span>
<a name="l00110"></a><a class="code" href="class_reconstructor__2_d.html#476b79f147c2675a08924aaf4a609ab6">00110</a>         C_min;        
<a name="l00111"></a>00111         %&gt; capacitance measurement from reprojection
<a name="l00112"></a><a class="code" href="class_reconstructor__2_d.html#9fd91d26acf0bf3882b0c320e95a10c6">00112</a>         Cr         
<a name="l00113"></a>00113         %&gt; capacitance vector for initial solution
<a name="l00114"></a><a class="code" href="class_reconstructor__2_d.html#6115b3ad133989b89374f2ebd84eb881">00114</a>         Cr_0;
<a name="l00115"></a>00115      
<a name="l00116"></a><a class="code" href="class_reconstructor__2_d.html#0c8566246eb2429f385a1e798d07bf96">00116</a>         
<a name="l00117"></a>00117         %&gt; real data from file (e.g. capacitance data from ET3)
<a name="l00118"></a>00118         data_from_file     
<a name="l00119"></a>00119         %&gt; flag 0-no real data 1-real values 
<a name="l00120"></a><a class="code" href="class_reconstructor__2_d.html#1ae41068d0d7b66057bbbdb00ae8abfb">00120</a>         real_data;                 
<a name="l00121"></a>00121         
<a name="l00122"></a><a class="code" href="class_reconstructor__2_d.html#9b2231e4a5fb36131636cdffd5bbd9fb">00122</a>         %&gt; set if previous image becomes current image
<a name="l00123"></a>00123         step_back_flag=0;        
<a name="l00124"></a>00124     end
<a name="l00125"></a><a class="code" href="class_reconstructor__2_d.html#b8a40770f2f9a36c65fd0a2d81f52e80">00125</a>     
<a name="l00126"></a>00126     methods
<a name="l00127"></a>00127         % =================================================================
<a name="l00128"></a>00128         %&gt; @brief Constructor.
<a name="l00129"></a>00129         %&gt;
<a name="l00130"></a>00130         %&gt; @param varargin{1} Ef_pha <a class="code" href="class_electrical__field.html" title="This is a abstract class.Describes how to compute sensitivity, potential maps and...">Electrical_field</a> <span class="keywordtype">object</span> with <span class="stringliteral">'main'</span> phantom
<a name="l00131"></a>00131         %&gt; @param varargin{2} Ef_max <a class="code" href="class_electrical__field.html" title="This is a abstract class.Describes how to compute sensitivity, potential maps and...">Electrical_field</a> <span class="keywordtype">object</span> with uniform max phantom 
<a name="l00132"></a>00132         %&gt; @param varargin{3} Ef_min <a class="code" href="class_electrical__field.html" title="This is a abstract class.Describes how to compute sensitivity, potential maps and...">Electrical_field</a> <span class="keywordtype">object</span> with uniform min phantom 
<a name="l00133"></a>00133         %&gt; @param varargin{4} Ef_avg <a class="code" href="class_electrical__field.html" title="This is a abstract class.Describes how to compute sensitivity, potential maps and...">Electrical_field</a> <span class="keywordtype">object</span> with uniform avg phantom         
<a name="l00134"></a>00134         %&gt;
<a name="l00135"></a>00135         %&gt; @<span class="keywordflow">return</span> instance of the <a class="code" href="class_reconstructor__2_d.html" title="Class used to reconstruct image.">Reconstructor_2D</a> <span class="keyword">class</span>.
<a name="l00136"></a>00136         % =================================================================                                   
<a name="l00137"></a>00137         function rec_obj=<a class="code" href="class_reconstructor__2_d.html" title="Class used to reconstruct image.">Reconstructor_2D</a>(varargin)
<a name="l00138"></a>00138            if nargin == 0 ; % no input arguments
<a name="l00139"></a>00139            elseif isa(varargin{1},<span class="stringliteral">'Reconstructor_2D'</span>)
<a name="l00140"></a>00140             rec_obj = varargin{1}; % copy constructor
<a name="l00141"></a>00141             <a class="code" href="display_8m.html#5b77131cc4d70e97cbcacda19d91e0a1" title="Overload matlabs function use to display.">display</a> <span class="stringliteral">'copy constructor Reconstructor_2D'</span>
<a name="l00142"></a>00142             <span class="keywordflow">return</span>;
<a name="l00143"></a>00143            <span class="keywordflow">else</span>
<a name="l00144"></a>00144                
<a name="l00145"></a>00145                rec_obj.Ef_pha=varargin{1};
<a name="l00146"></a>00146                rec_obj.Ef_max=varargin{2};
<a name="l00147"></a>00147                rec_obj.Ef_min=varargin{3};                                            
<a name="l00148"></a>00148                rec_obj.Ef_avg=varargin{4};
<a name="l00149"></a>00149                                                           
<a name="l00150"></a>00150                rec_obj.method=<span class="stringliteral">'LM'</span>;
<a name="l00151"></a>00151                rec_obj.numiter=151;
<a name="l00152"></a>00152                rec_obj.stop_delta=1e-20;
<a name="l00153"></a>00153                rec_obj.update_method=<span class="stringliteral">'modulo'</span>;
<a name="l00154"></a>00154                rec_obj.iter_mod=50;
<a name="l00155"></a>00155                rec_obj.update_delta=0;
<a name="l00156"></a>00156                rec_obj.alpha=0.05;
<a name="l00157"></a>00157                rec_obj.alpha_=0.05; %alpha_=alpha;
<a name="l00158"></a>00158                rec_obj.alphalimit=<span class="stringliteral">'noadapt'</span>;
<a name="l00159"></a>00159                rec_obj.regular=<span class="stringliteral">'manual'</span>;
<a name="l00160"></a>00160                rec_obj.u=0.05;
<a name="l00161"></a>00161                                                                   
<a name="l00162"></a>00162                rec_obj.matrix_size=rec_obj.Ef_pha.discret_matrix_size;
<a name="l00163"></a>00163                
<a name="l00164"></a>00164                Ef_pha=rec_obj.Ef_pha;
<a name="l00165"></a>00165                Ef_max=rec_obj.Ef_max;
<a name="l00166"></a>00166                Ef_min=rec_obj.Ef_min;                              
<a name="l00167"></a>00167                Ef_avg=rec_obj.Ef_avg;
<a name="l00168"></a>00168                
<a name="l00169"></a>00169                rec_obj.step_back_flag=0;
<a name="l00170"></a>00170                real_data=0;
<a name="l00171"></a>00171                
<a name="l00172"></a>00172             % #########################################################################
<a name="l00173"></a>00173             % <span class="keywordtype">object</span> we are looking <span class="keywordflow">for</span> - unknown permittivity (epsilon) distribution
<a name="l00174"></a>00174             % and the sensitivity calculated for this distribution (true model)
<a name="l00175"></a>00175             %  1. numerical phantom - <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> case of simulation
<a name="l00176"></a>00176             %  2. mathematical model - <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> case of reconstruction from real object
<a name="l00177"></a>00177             %  3. maximum epsilon value when we do not know what we reconstruct
<a name="l00178"></a>00178            
<a name="l00179"></a>00179             rec_obj.Ep_Pha      = Ef_pha.Eps_fovImgToReconstruction;        % vector
<a name="l00180"></a>00180             rec_obj.Ep_Pha_map  = Ef_pha.Eps_fovImgToReconstruction_map; % map
<a name="l00181"></a>00181             rec_obj.S_Pha       = Ef_pha.S_resize;
<a name="l00182"></a>00182             rec_obj.S_Pha_map   = Ef_pha.S_map_resize;
<a name="l00183"></a>00183             
<a name="l00184"></a>00184             
<a name="l00185"></a>00185             % #########################################################################
<a name="l00186"></a>00186             % maximum &amp; minimum value permittivity (epsilon) distribution
<a name="l00187"></a>00187             rec_obj.Ep_min = Ef_min.Eps_fovImgToReconstruction; 
<a name="l00188"></a>00188             rec_obj.Ep_min_map = Ef_min.Eps_fovImgToReconstruction_map;
<a name="l00189"></a>00189             rec_obj.Ep_max = Ef_max.Eps_fovImgToReconstruction; 
<a name="l00190"></a>00190             rec_obj.Ep_max_map = Ef_max.Eps_fovImgToReconstruction_map;
<a name="l00191"></a>00191             
<a name="l00192"></a>00192             
<a name="l00193"></a>00193             % <span class="preprocessor">#########################################################################            </span>
<a name="l00194"></a>00194 <span class="preprocessor"></span>            % initial (start) resize solution 
<a name="l00195"></a>00195             % at this moment we start from uniform distribution with minimum value
<a name="l00196"></a>00196             % or take a priori 
<a name="l00197"></a>00197             rec_obj.Ep_0_map = Ef_avg.Eps_fovImgToReconstruction_map;
<a name="l00198"></a>00198             rec_obj.Ep_0     = Ef_avg.Eps_fovImgToReconstruction;
<a name="l00199"></a>00199            
<a name="l00200"></a>00200             
<a name="l00201"></a>00201             rec_obj.S_0     =  Ef_min.S_resize;
<a name="l00202"></a>00202             rec_obj.S_0_map =  Ef_min.S_map_resize;            
<a name="l00203"></a>00203             
<a name="l00204"></a>00204             rec_obj.Ep      = rec_obj.Ep_0;      
<a name="l00205"></a>00205             rec_obj.Ep_map  = rec_obj.Ep_0_map; 
<a name="l00206"></a>00206             rec_obj.Ep_     = rec_obj.Ep_0;      
<a name="l00207"></a>00207             rec_obj.Ep_map_ = rec_obj.Ep_0_map; 
<a name="l00208"></a>00208             rec_obj.S       = rec_obj.S_0;  
<a name="l00209"></a>00209             rec_obj.S_map   = rec_obj.S_0_map;
<a name="l00210"></a>00210             
<a name="l00211"></a>00211             % <span class="preprocessor">#########################################################################</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>            % reprojection - projection for initial solution
<a name="l00213"></a>00213             rec_obj.C_max = rec_obj.S*rec_obj.Ep_max; 
<a name="l00214"></a>00214             rec_obj.C_min = rec_obj.S*rec_obj.Ep_min; 
<a name="l00215"></a>00215 
<a name="l00216"></a>00216             rec_obj.Cr_0  = rec_obj.S*rec_obj.Ep;
<a name="l00217"></a>00217             %Cr_0  = (Cr_0-C_min)./(C_max-C_min);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219             % normalized measurement
<a name="l00220"></a>00220             rec_obj.Cm_n = (Ef_pha.C-Ef_min.C)./(Ef_max.C-Ef_min.C);
<a name="l00221"></a>00221             % Cm   = Cm_n;
<a name="l00222"></a>00222             % <a class="code" href="projections_8m.html#e8d70bf010f198d73417f1a179fb6079" title="projections calculates capacitances to be measured with phantom">projections</a> denormalization <span class="keyword">using</span> simulated max &amp; min
<a name="l00223"></a>00223             rec_obj.Cm   = rec_obj.C_min + rec_obj.Cm_n.*(rec_obj.C_max-rec_obj.C_min);
<a name="l00224"></a>00224             rec_obj.Cr   = rec_obj.Cr_0;
<a name="l00225"></a>00225                         
<a name="l00226"></a>00226            end
<a name="l00227"></a>00227         end
<a name="l00228"></a>00228         
<a name="l00229"></a>00229         % =====================================================================
<a name="l00230"></a>00230         %&gt; @brief <a class="code" href="it__recon_8m.html#55a6e70cc3364ca64b0c64031c2b3cff" title="it_recon performs general scheme of iterative reconstruction.">it_recon</a> performs general scheme of iterative reconstruction.
<a name="l00231"></a>00231         %&gt; Function is overload.
<a name="l00232"></a>00232         %&gt;         
<a name="l00233"></a>00233         %&gt; @param First:varargin{1} disp_mode <span class="stringliteral">'display'</span> or <span class="stringliteral">'no_display'</span> during reconstruction
<a name="l00234"></a>00234         %&gt;
<a name="l00235"></a>00235         %&gt; @param Second:varargin{1} algorithm params (<span class="keyword">struct</span>), <span class="keyword">struct </span>properties are:
<a name="l00236"></a>00236         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method iterative algorithm method (equation <span class="keywordflow">for</span> one step)
<a name="l00237"></a>00237         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'LBP'</span> linearized backprojection
<a name="l00238"></a>00238         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'Landweber'</span> gradient steepest descent with small step (<span class="keywordflow">default</span>)
<a name="l00239"></a>00239         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'LandweberNormalized'</span> Landweber <span class="keywordflow">for</span> normalized data
<a name="l00240"></a>00240         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'NewtonRaphson'</span> nonlinear Gauss-Newton with regularization
<a name="l00241"></a>00241         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'NewtonRaphsonConstrained'</span> nonlinear Gauss-Newton with regularization and a constrain
<a name="l00242"></a>00242         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:method:name <span class="stringliteral">'LM'</span> nonlinear Gauss-Newton with Marquardt regularization        
<a name="l00243"></a>00243         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:numiter     stop after <span class="stringliteral">'numiter'</span> iterations
<a name="l00244"></a>00244         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:stop_delta  stop when image changes are lower than <span class="stringliteral">'stop_delta'</span>
<a name="l00245"></a>00245         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:update_method <span class="stringliteral">'modulo'</span> or <span class="stringliteral">'auto'</span> method of selecting moment <span class="keywordflow">for</span> sensitivity matrix update
<a name="l00246"></a>00246         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:iter_mod      update sensitivity matrix modulo <span class="stringliteral">'iter_mod'</span> iteration 
<a name="l00247"></a>00247         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:update_delta  update sensitivity where dC becomes lower than <span class="stringliteral">'update_delta'</span>
<a name="l00248"></a>00248         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:alpha         relaxation factor (step length)
<a name="l00249"></a>00249         %&gt; @param Second:varargin{1}:<span class="keyword">struct</span>:alphalimit    limitation of relaxation factor: <span class="stringliteral">'adapt or '</span>noadapt<span class="stringliteral">'</span>
<a name="l00250"></a>00250 <span class="stringliteral">        %&gt; @param Second:varargin{1}:struct:regular       '</span>manual<span class="stringliteral">', '</span>l_curve<span class="stringliteral">' or '</span>GCV<span class="stringliteral">' selection of regularization parameter u</span>
<a name="l00251"></a>00251 <span class="stringliteral">        %&gt; @param Second:varargin{1}:struct:u            Thikonov regularization factor for matrix pseudo inverse</span>
<a name="l00252"></a>00252 <span class="stringliteral">        %&gt; @param Second:varargin{2} disp_mode '</span><a class="code" href="display_8m.html#5b77131cc4d70e97cbcacda19d91e0a1" title="Overload matlabs function use to display.">display</a><span class="stringliteral">' or '</span>no_display<span class="stringliteral">' during reconstruction</span>
<a name="l00253"></a>00253 <span class="stringliteral">        %&gt;</span>
<a name="l00254"></a>00254 <span class="stringliteral">        %&gt; @retval Ep new better estimation of permittivity</span>
<a name="l00255"></a>00255 <span class="stringliteral">        % =====================================================================</span>
<a name="l00256"></a>00256 <span class="stringliteral">        function  [Ep] = it_recon(varargin) </span>
<a name="l00257"></a>00257 <span class="stringliteral">        [Ep] = it_recon(varargin);</span>
<a name="l00258"></a>00258 <span class="stringliteral">        </span>
<a name="l00259"></a>00259 <span class="stringliteral">        % =====================================================================</span>
<a name="l00260"></a>00260 <span class="stringliteral">        %&gt; @brief fuction reads measured data from a capacitance tomograph, and set</span>
<a name="l00261"></a>00261 <span class="stringliteral">        %&gt; this value to start solution</span>
<a name="l00262"></a>00262 <span class="stringliteral">        %&gt;</span>
<a name="l00263"></a>00263 <span class="stringliteral">        %&gt; @param file_name  a name of a file contained measuring data</span>
<a name="l00264"></a>00264 <span class="stringliteral">        %&gt; @param M          number of measurements</span>
<a name="l00265"></a>00265 <span class="stringliteral">        %&gt; @param frame1     number of frame contained capacitance measurements.</span>
<a name="l00266"></a>00266 <span class="stringliteral">        %&gt; @param frame2     number of frame contained capacitance measurements.</span>
<a name="l00267"></a>00267 <span class="stringliteral">        %&gt;</span>
<a name="l00268"></a>00268 <span class="stringliteral">        %&gt; @retval object.C_meas  capacitance maeaurements</span>
<a name="l00269"></a>00269 <span class="stringliteral">        %&gt; @retval object.C_min   minimal values of capacitances</span>
<a name="l00270"></a>00270 <span class="stringliteral">        %&gt; @retval object.C_max   maximal values of capacitances</span>
<a name="l00271"></a>00271 <span class="stringliteral">        % =====================================================================</span>
<a name="l00272"></a>00272 <span class="stringliteral">        function [object] = read_data(rec_obj,file_name,M,frame1,frame2)</span>
<a name="l00273"></a>00273 <span class="stringliteral">        [object] = read_data(rec_obj,file_name,M,frame1,frame2);</span>
<a name="l00274"></a>00274 <span class="stringliteral">                                     </span>
<a name="l00275"></a>00275 <span class="stringliteral">        % =================================================================</span>
<a name="l00276"></a>00276 <span class="stringliteral">        %&gt; @brief Display use during it_recon works</span>
<a name="l00277"></a>00277 <span class="stringliteral">        % =================================================================</span>
<a name="l00278"></a>00278 <span class="stringliteral">        function display(rec_obj)</span>
<a name="l00279"></a>00279 <span class="stringliteral">           if mod(rec_obj.current_iter,rec_obj.iter_mod+1)==0 </span>
<a name="l00280"></a>00280 <span class="stringliteral">            fh_cm = figure (3021);</span>
<a name="l00281"></a>00281 <span class="stringliteral">            set(fh_cm,'</span>Name<span class="charliteral">','</span>Measurements: max (\^), min (v), object (+), reprojection <span class="keywordflow">for</span> current estimate (o)<span class="stringliteral">');</span>
<a name="l00282"></a>00282 <span class="stringliteral">            plot(rec_obj.C_max,'</span>r-^');
<a name="l00283"></a>00283             hold on;
<a name="l00284"></a>00284             plot(rec_obj.C_min,<span class="stringliteral">'g-v'</span>);
<a name="l00285"></a>00285             plot(rec_obj.Cm,<span class="stringliteral">'k-+'</span>);
<a name="l00286"></a>00286             plot(rec_obj.Cr,<span class="stringliteral">'b-o'</span>);
<a name="l00287"></a>00287             hold off;
<a name="l00288"></a>00288             title(<span class="stringliteral">'Measurements: max (\^), min (v), object (+), reprojection for current estimate (o)'</span>);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 
<a name="l00291"></a>00291             fh_cm2 = figure (3022);
<a name="l00292"></a>00292             <span class="keyword">set</span>(fh_cm2,<span class="stringliteral">'Name'</span>,<span class="stringliteral">'C measured (+) and recalulated (o)'</span>);
<a name="l00293"></a>00293             plot(rec_obj.Cm,<span class="stringliteral">'k-+'</span>);
<a name="l00294"></a>00294             hold on;
<a name="l00295"></a>00295             plot(rec_obj.Cr,<span class="stringliteral">'b-o'</span>);
<a name="l00296"></a>00296             hold off;
<a name="l00297"></a>00297             title(<span class="stringliteral">'C measured (+) and recalulated (o)'</span>);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299             fh_dc = figure (3023); 
<a name="l00300"></a>00300             <span class="keyword">set</span>(fh_dc,<span class="stringliteral">'Name'</span>,<span class="stringliteral">'Cr - Cm'</span>);            
<a name="l00301"></a>00301             Cr_Cm=rec_obj.Cr-rec_obj.Cm;
<a name="l00302"></a>00302             plot(Cr_Cm,<span class="stringliteral">'r-*'</span>);
<a name="l00303"></a>00303             title(<span class="stringliteral">'Cr - Cm'</span>);
<a name="l00304"></a>00304             xlabel(<span class="stringliteral">'Pair of electrodes'</span>);
<a name="l00305"></a>00305             ylabel(<span class="stringliteral">'Capacitance difference'</span>);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307             fh_err = figure(3024);
<a name="l00308"></a>00308             <span class="keyword">set</span>(fh_err,<span class="stringliteral">'Name'</span>,<span class="stringliteral">'Normalized errors: Capacitance (+), Image (o), Sensitivity (\^)'</span>);
<a name="l00309"></a>00309             rec_obj.xplot(rec_obj.errors.Cap,<span class="stringliteral">'k-'</span>,<span class="stringliteral">'k+'</span>);
<a name="l00310"></a>00310             hold on;
<a name="l00311"></a>00311             rec_obj.xplot(rec_obj.errors.Imag,<span class="stringliteral">'b-'</span>,<span class="stringliteral">'bo'</span>);
<a name="l00312"></a>00312             rec_obj.xplot(rec_obj.errors.Sens,<span class="stringliteral">'g-'</span>,<span class="stringliteral">'g^'</span>)
<a name="l00313"></a>00313             hold off;
<a name="l00314"></a>00314             title(<span class="stringliteral">'Normalized errors: Capacitance (+), Image (o), Sensitivity (\^)'</span>);
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 
<a name="l00317"></a>00317            end
<a name="l00318"></a>00318      
<a name="l00319"></a>00319     
<a name="l00320"></a>00320         <span class="keywordflow">if</span> mod(rec_obj.current_iter,rec_obj.iter_mod+1)==0 
<a name="l00321"></a>00321         % electrodes and screen have very high epsylon value
<a name="l00322"></a>00322         
<a name="l00323"></a>00323         Ep_draw=reshape(rec_obj.Ep_map,rec_obj.Ef_pha.simulation_discret_matrix_size,rec_obj.Ef_pha.simulation_discret_matrix_size);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325         % drawedP = log(P+1); 
<a name="l00326"></a>00326         vmax = max(max(Ep_draw)); 
<a name="l00327"></a>00327         rec_obj.draw_map(3030,<span class="stringliteral">'Solution at i-th iteration'</span>,0,vmax, Ep_draw);
<a name="l00328"></a>00328                 
<a name="l00329"></a>00329         end
<a name="l00330"></a>00330         
<a name="l00331"></a>00331    end
<a name="l00332"></a>00332         
<a name="l00333"></a>00333         % =================================================================
<a name="l00334"></a>00334         %&gt; @brief Display permittivity map <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> i-th iteration
<a name="l00335"></a>00335         %&gt;
<a name="l00336"></a>00336         %&gt; @param iter number of iteration        
<a name="l00337"></a>00337         % =================================================================
<a name="l00338"></a>00338         function Eps_at_iter(rec_obj,num)
<a name="l00339"></a>00339             if (num&lt;=rec_obj.maps_number)
<a name="l00340"></a>00340                 map=rec_obj.Ep_maps_iter(:,:,num);
<a name="l00341"></a>00341                 image(map,<span class="stringliteral">'cdatamapping'</span>,<span class="stringliteral">'scaled'</span>);
<a name="l00342"></a>00342                 <span class="keyword">set</span>(gca,<span class="stringliteral">'PlotBoxAspectRatio'</span>,[1,1,1]);
<a name="l00343"></a>00343                 min_v=min(min(map));
<a name="l00344"></a>00344                 max_v=max(max(map));
<a name="l00345"></a>00345                 <span class="keywordflow">if</span> (max_v&lt;=min_v)
<a name="l00346"></a>00346                     max_v=max_v+1;
<a name="l00347"></a>00347                 end
<a name="l00348"></a>00348                 caxis([min_v,max_v]);
<a name="l00349"></a>00349             end
<a name="l00350"></a>00350         end
<a name="l00351"></a>00351         
<a name="l00352"></a>00352         % =================================================================
<a name="l00353"></a>00353         %&gt; @brief Draw reconstruction permittivity, sensitivity and
<a name="l00354"></a>00354         %&gt; capacitance errors on the same figure.
<a name="l00355"></a>00355         % =================================================================
<a name="l00356"></a>00356         function draw_errors(rec_obj)
<a name="l00357"></a>00357             hold on;
<a name="l00358"></a>00358             rec_obj.<a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a>(rec_obj.errors.Cap,'k-','k+');            
<a name="l00359"></a>00359             rec_obj.<a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a>(rec_obj.errors.Imag,'b-','bo');
<a name="l00360"></a>00360             rec_obj.<a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a>(rec_obj.errors.Sens,'g-','g^');
<a name="l00361"></a>00361             hold off;
<a name="l00362"></a>00362             title('Discrepancy: Capacitance (+), Image (o), Sensitivity (\^)');
<a name="l00363"></a>00363             xlabel('Iteration')
<a name="l00364"></a>00364             ylabel('Normalized errors');
<a name="l00365"></a>00365         end
<a name="l00366"></a>00366         
<a name="l00367"></a>00367         % =================================================================
<a name="l00368"></a>00368         %&gt; @brief Draw maximal, minimal, measure and 'reconstruct'
<a name="l00369"></a>00369         %&gt; capacitances on the same figure.
<a name="l00370"></a>00370         %
<a name="l00371"></a>00371         %&gt; @param numb number of 'reconstruct' capacitance
<a name="l00372"></a>00372         % =================================================================
<a name="l00373"></a>00373         function draw_all_capacitances(rec_obj,numb)
<a name="l00374"></a>00374             plot(rec_obj.C_max,'r-^');
<a name="l00375"></a>00375             hold on;
<a name="l00376"></a>00376             plot(rec_obj.C_min,'g-v');
<a name="l00377"></a>00377             % Cm is static (no change during <a class="code" href="it__recon_8m.html#55a6e70cc3364ca64b0c64031c2b3cff" title="it_recon performs general scheme of iterative reconstruction.">it_recon</a> compute)
<a name="l00378"></a>00378             plot(rec_obj.Cm,'k-+');
<a name="l00379"></a>00379             plot(rec_obj.Cr_iter(:,numb),'b-o');
<a name="l00380"></a>00380             hold off;
<a name="l00381"></a>00381             title(' Meas: max (\^), min (v), <span class="keywordtype">object</span> (+), reprojection for current estimate (o)');
<a name="l00382"></a>00382             ylabel('Capacitance difference [arbitrary units]');
<a name="l00383"></a>00383             xlabel('Pair of electrodes');   
<a name="l00384"></a>00384         end
<a name="l00385"></a>00385         
<a name="l00386"></a>00386         % =================================================================
<a name="l00387"></a>00387         %&gt; @brief Draw measured and i-th 'reconstruct' capacitance on the
<a name="l00388"></a>00388         %&gt; same figure.
<a name="l00389"></a>00389         %
<a name="l00390"></a>00390         %&gt; @param numb number of 'reconstruct' capacitance
<a name="l00391"></a>00391         % =================================================================
<a name="l00392"></a>00392         function draw_Cm_Cr(rec_obj,numb)
<a name="l00393"></a>00393             plot(rec_obj.Cm,'k-+');
<a name="l00394"></a>00394             hold on;
<a name="l00395"></a>00395             plot(rec_obj.Cr_iter(:,numb),'b-o');
<a name="l00396"></a>00396             hold off;
<a name="l00397"></a>00397             ylabel('Capacitance difference [arbitrary units]');
<a name="l00398"></a>00398             xlabel('Pair of electrodes');
<a name="l00399"></a>00399             title('C measured (+) and recalculated (o)');
<a name="l00400"></a>00400         end
<a name="l00401"></a>00401         
<a name="l00402"></a>00402         % =================================================================
<a name="l00403"></a>00403         %&gt; @brief Draw difference between measured and i-th 'reconstruct'
<a name="l00404"></a>00404         %&gt; capacitance.
<a name="l00405"></a>00405         %&gt;
<a name="l00406"></a>00406         %&gt; @param numb number of 'reconstruct' capacitance
<a name="l00407"></a>00407         % =================================================================
<a name="l00408"></a>00408         function draw_capacitance_diff(rec_obj,num)
<a name="l00409"></a>00409             Cr_Cm=rec_obj.Cr_iter(num)-rec_obj.Cm;
<a name="l00410"></a>00410             plot(Cr_Cm,'r-*');
<a name="l00411"></a>00411             title('Cr - Cm');
<a name="l00412"></a>00412             xlabel('Pair of electrodes');
<a name="l00413"></a>00413             ylabel('Capacitance difference [arbitrary units]'); 
<a name="l00414"></a>00414         end
<a name="l00415"></a>00415         
<a name="l00416"></a>00416         % =================================================================
<a name="l00417"></a>00417         %&gt; @brief Draw algorithm parameters(step, updating, regularization values)                
<a name="l00418"></a>00418         % =================================================================
<a name="l00419"></a>00419         function draw_alg_params(rec_obj)
<a name="l00420"></a>00420             plot(rec_obj.param.Alpha,'k-+');
<a name="l00421"></a>00421             hold on;
<a name="l00422"></a>00422             plot(rec_obj.param.U,'b-o');
<a name="l00423"></a>00423             plot(rec_obj.param.Updating,'g-^');
<a name="l00424"></a>00424     
<a name="l00425"></a>00425             hold off;
<a name="l00426"></a>00426             title('Algorithm parameters: Alpha (+), Regularization U (o),  Updating (\^)');
<a name="l00427"></a>00427             xlabel('Iteration')
<a name="l00428"></a>00428             ylabel('Parameter value');
<a name="l00429"></a>00429         end
<a name="l00430"></a>00430              
<a name="l00431"></a>00431         % =================================================================
<a name="l00432"></a>00432         %&gt; @brief Draw real measured capacitances. First read file.        
<a name="l00433"></a>00433         % =================================================================
<a name="l00434"></a>00434         function draw_real_data_from_file(rec_obj)
<a name="l00435"></a>00435             if(rec_obj.real_data==1)                
<a name="l00436"></a>00436                 fh_rdata=figure();            
<a name="l00437"></a>00437                 set(fh_rdata,'Name','Real Data Capacitance');
<a name="l00438"></a>00438                 hold on;
<a name="l00439"></a>00439                 plot(rec_obj.data_from_file.C_meas,'b-+');
<a name="l00440"></a>00440                 plot(rec_obj.data_from_file.C_max,'r-^');
<a name="l00441"></a>00441                 plot(rec_obj.data_from_file.C_min,'g-o');
<a name="l00442"></a>00442                 hold off;
<a name="l00443"></a>00443                 title('Real Data (Capacitance): Measured (+), Max (\^),  Min (o)');
<a name="l00444"></a>00444                 xlabel('Pair of electrodes');
<a name="l00445"></a>00445                 ylabel('Capacitance difference [arbitrary units]');
<a name="l00446"></a>00446             else
<a name="l00447"></a>00447                 error('No data from real model to <a class="code" href="display_8m.html#5b77131cc4d70e97cbcacda19d91e0a1" title="Overload matlabs function use to display.">display</a>. First read file.');
<a name="l00448"></a>00448             end
<a name="l00449"></a>00449         end
<a name="l00450"></a>00450         
<a name="l00451"></a>00451     end
<a name="l00452"></a>00452     
<a name="l00453"></a>00453     methods (Access=private)
<a name="l00454"></a>00454         
<a name="l00455"></a>00455         % =====================================================================
<a name="l00456"></a>00456         %&gt; @brief % <a class="code" href="step__length_8m.html#55c2c28e93a1ea47d5fc06bfef1b382d" title="% step_length calculates optimal steps alpha and beta by minimizing |c-Se(i+1| norm...">step_length</a> calculates optimal steps alpha and beta
<a name="l00457"></a>00457         %&gt; by minimizing |c-Se(i+1| norm for next step
<a name="l00458"></a>00458         %&gt; e(i+1)=e(i) + a inv(S'(SS'+uI))(c-Se(i))
<a name="l00459"></a>00459         %&gt;
<a name="l00460"></a>00460         %&gt; @param S    sensitivity matrix
<a name="l00461"></a>00461         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00462"></a>00462         %&gt; @param Cm   vector of measured capacitances
<a name="l00463"></a>00463         %&gt; @param Ep   current estimation of permittivity distribution (column vector)
<a name="l00464"></a>00464         %&gt; @param Epp  previous estimation of permittivity distribution (column vector)
<a name="l00465"></a>00465         %&gt; @param u    Thikonov regularization factor for matrix pseudo inverse
<a name="l00466"></a>00466         %&gt; @retval alpha,beta optimal step lengths
<a name="l00467"></a>00467         % =====================================================================
<a name="l00468"></a>00468         function [a b] = <a class="code" href="step__length_8m.html#55c2c28e93a1ea47d5fc06bfef1b382d" title="% step_length calculates optimal steps alpha and beta by minimizing |c-Se(i+1| norm...">step_length</a>(rec_obj,S,Cr,Cm,Ep,Epp,u)
<a name="l00469"></a>00469         [a b] = <a class="code" href="step__length_8m.html#55c2c28e93a1ea47d5fc06bfef1b382d" title="% step_length calculates optimal steps alpha and beta by minimizing |c-Se(i+1| norm...">step_length</a>(rec_obj,S,Cr,Cm,Ep,Epp,u);
<a name="l00470"></a>00470         
<a name="l00471"></a>00471         % =====================================================================
<a name="l00472"></a>00472         %&gt; @brief <a class="code" href="alg___l_b_p_8m.html#3c403917bb65758d314d51b2b3e8bc56" title="alg_LBP calculates one step LBP">alg_LBP</a> calculates one step LBP
<a name="l00473"></a>00473         %&gt;
<a name="l00474"></a>00474         %&gt; @param Sn    sensitivity matrix normalized
<a name="l00475"></a>00475         %&gt; @param Cm_n  vector of measured normalizedcapacitances
<a name="l00476"></a>00476         %&gt;
<a name="l00477"></a>00477         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00478"></a>00478         % =====================================================================
<a name="l00479"></a>00479         function Ep = <a class="code" href="alg___l_b_p_8m.html#3c403917bb65758d314d51b2b3e8bc56" title="alg_LBP calculates one step LBP">alg_LBP</a>(rec_obj,Cm_n,Sn)
<a name="l00480"></a>00480         Ep = <a class="code" href="alg___l_b_p_8m.html#3c403917bb65758d314d51b2b3e8bc56" title="alg_LBP calculates one step LBP">alg_LBP</a>(rec_obj,Cm,Sn);
<a name="l00481"></a>00481                       
<a name="l00482"></a>00482         % =========================================================================
<a name="l00483"></a>00483         %&gt; @brief <a class="code" href="recon__qual_8m.html#42bf42ea0edc999d77ee6c3dcc779188" title="recon_qual calculates norms for image (permittivity distribution), sensitivity matrix...">recon_qual</a> calculates norms for image (permittivity distribution),
<a name="l00484"></a>00484         %&gt; sensitivity matrix and measurement
<a name="l00485"></a>00485         %&gt; <a class="code" href="recon__qual_8m.html#42bf42ea0edc999d77ee6c3dcc779188" title="recon_qual calculates norms for image (permittivity distribution), sensitivity matrix...">recon_qual</a> calculates norms for image (permittivity distribution),
<a name="l00486"></a>00486         %&gt; sensitivity matrix and measurement
<a name="l00487"></a>00487         %&gt; the discrepancy (normalized square norm)
<a name="l00488"></a>00488         %&gt; 1. between numerical phantom or model and reconstructed image
<a name="l00489"></a>00489         %&gt; 2. between sensitivity matrix for phantom and sensitivity 
<a name="l00490"></a>00490         %&gt;    matrix for solution estimate
<a name="l00491"></a>00491         %&gt; 3. between measured values and reprojected using current solution estimate
<a name="l00492"></a>00492         %&gt; 
<a name="l00493"></a>00493         %&gt; @param Ep_Pha  permittivity distribution of numerical phantom or model
<a name="l00494"></a>00494         %&gt; @param S_Pha   sensitivity matrix calculated for phantom or model
<a name="l00495"></a>00495         %&gt; @param Cm      measurements - real values
<a name="l00496"></a>00496         %&gt; @param Ep_0    permittivity distribution of initial (start) solution Ep(0)
<a name="l00497"></a>00497         %&gt; @param S_0     sensitivity matrix calculated for initial solution Ep(0)
<a name="l00498"></a>00498         %&gt; @param Cr_0    measurements - reprojected values for initial solution Ep(0)
<a name="l00499"></a>00499         %&gt; @param Ep      permittivity distribution - current solution estimate Ep(i)
<a name="l00500"></a>00500         %&gt; @param S       sensitivity matrix calculated for current solution estimate S(i)
<a name="l00501"></a>00501         %&gt; @param Cr      measurements - reprojected values for current solution Ep(i)
<a name="l00502"></a>00502         %&gt; @param scale   '2one' to scaling to 1 or 'norm' to normalize
<a name="l00503"></a>00503         %&gt;
<a name="l00504"></a>00504         %&gt; @retval Cap_err   vector of normalized L2 distance <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> measurement domain
<a name="l00505"></a>00505         %&gt; @retval Imag_err  vector of normalized L2 distance <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> image domain
<a name="l00506"></a>00506         %&gt; @retval Sens_err  vector of normalized L2 distance between models
<a name="l00507"></a>00507         % =========================================================================
<a name="l00508"></a>00508         function [Cap_err Imag_err Sens_err] = <a class="code" href="recon__qual_8m.html#42bf42ea0edc999d77ee6c3dcc779188" title="recon_qual calculates norms for image (permittivity distribution), sensitivity matrix...">recon_qual</a> (rec_obj,Ep_Pha, S_Pha, Cm, Ep_0, S_0, Cr_0, Ep, S, Cr, scale)
<a name="l00509"></a>00509         [Cap_err Imag_err Sens_err] = <a class="code" href="recon__qual_8m.html#42bf42ea0edc999d77ee6c3dcc779188" title="recon_qual calculates norms for image (permittivity distribution), sensitivity matrix...">recon_qual</a> (rec_obj,Ep_Pha, S_Pha, Cm, Ep_0, S_0, Cr_0, Ep, S, Cr, scale)
<a name="l00510"></a>00510         
<a name="l00511"></a>00511         
<a name="l00512"></a>00512         % =====================================================================
<a name="l00513"></a>00513         %&gt; @brief <a class="code" href="fov__center_8m.html#b49eb4eafc1104f72236237dc8e61d2b" title="fov_center gets center of fov from sensitivity maps">fov_center</a> gets center of fov from sensitivity maps 
<a name="l00514"></a>00514         %&gt;
<a name="l00515"></a>00515         %&gt; @param sensor     sensor <span class="keywordtype">object</span>
<a name="l00516"></a>00516         %&gt; @param S_Pha_map  sensitivity map calculated for phantom or model
<a name="l00517"></a>00517         %&gt; @param S_0_map    sensitivity map calculated for initial solution Ep(0)
<a name="l00518"></a>00518         %&gt; @param S_map      sensitivity map calculated for current solution estimate S(i)
<a name="l00519"></a>00519         %&gt;
<a name="l00520"></a>00520         %&gt; @retval S_Pha   sensitivity matrix calculated for phantom or model
<a name="l00521"></a>00521         %&gt; @retval S_0     sensitivity matrix calculated for initial solution Ep(0)
<a name="l00522"></a>00522         %&gt; @retval S       sensitivity matrix calculated for current solution estimate S(i)
<a name="l00523"></a>00523         % =====================================================================
<a name="l00524"></a>00524         function [S_Pha, S_0, S] = <a class="code" href="fov__center_8m.html#b49eb4eafc1104f72236237dc8e61d2b" title="fov_center gets center of fov from sensitivity maps">fov_center</a> (rec_obj, sensor, S_Pha_map, S_0_map, S_map)
<a name="l00525"></a>00525         [S_Pha, S_0, S] = <a class="code" href="fov__center_8m.html#b49eb4eafc1104f72236237dc8e61d2b" title="fov_center gets center of fov from sensitivity maps">fov_center</a> (rec_obj, S_Pha_map, S_0_map, S_map);
<a name="l00526"></a>00526         
<a name="l00527"></a>00527         %[S]= <a class="code" href="reshape__sens_8m.html#c1bb238656d0447e4c1734d9f5e54ce2" title="reshape_sens reshape vector sensitivity maps to single matrix">reshape_sens</a>(rec_obj,S_map, map_size, sens_matrix_num);
<a name="l00528"></a>00528         
<a name="l00529"></a>00529         % =====================================================================
<a name="l00530"></a>00530         %&gt; @brief <a class="code" href="alg___leven_marq___limit_8m.html#bc4beea8f7a9a29a101c7a7e3142fcdc" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration with constrain...">alg_LevenMarq_Limit</a> calculates one step of Levenberg Marquard iteration
<a name="l00531"></a>00531         %&gt; with constrain for permittivity value, that is not less than 1
<a name="l00532"></a>00532         %&gt;
<a name="l00533"></a>00533         %&gt; @param S    sensitivity matrix
<a name="l00534"></a>00534         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00535"></a>00535         %&gt; @param Cm   vector of measured capacitances
<a name="l00536"></a>00536         %&gt; @param Ep   current estimation of permittivity distribution (previous step) <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> form of column vector
<a name="l00537"></a>00537         %&gt; @param alfa relaxation factor (step length)
<a name="l00538"></a>00538         %&gt; @param u    Thikonov regularization factor for matrix pseudo inverse
<a name="l00539"></a>00539         %&gt; @param constrain 'constrain' to limit permittivity value
<a name="l00540"></a>00540         %&gt; @param lt   lower threshold
<a name="l00541"></a>00541         %&gt; @param ut   upper threshold
<a name="l00542"></a>00542         %&gt;
<a name="l00543"></a>00543         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00544"></a>00544         % =====================================================================
<a name="l00545"></a>00545         function Ep = <a class="code" href="alg___leven_marq___limit_8m.html#bc4beea8f7a9a29a101c7a7e3142fcdc" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration with constrain...">alg_LevenMarq_Limit</a>(rec_obj,S,Cr,Cm,Ep,alfa,u,constrain,lt,ut)
<a name="l00546"></a>00546         Ep = <a class="code" href="alg___leven_marq___limit_8m.html#bc4beea8f7a9a29a101c7a7e3142fcdc" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration with constrain...">alg_LevenMarq_Limit</a>(rec_obj,S,Cr,Cm,Ep,alfa,u,constrain,lt,ut);
<a name="l00547"></a>00547         
<a name="l00548"></a>00548         % =====================================================================
<a name="l00549"></a>00549         %&gt; @brief <a class="code" href="alg___newton_ra___limit_8m.html#9df9122c11556ea258de56170cd64ea4" title="alg_NewtonRa_Limit calculates one step of Newton Raphson iteration with constrain...">alg_NewtonRa_Limit</a> calculates one step of Newton Raphson iteration
<a name="l00550"></a>00550         %&gt; with constrain for permittivity value, that is not less than 1
<a name="l00551"></a>00551         %&gt;
<a name="l00552"></a>00552         %&gt; @param S    sensitivity matrix
<a name="l00553"></a>00553         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00554"></a>00554         %&gt; @param Cm   vector of measured capacitances
<a name="l00555"></a>00555         %&gt; @param Ep   current estimation of permittivity distribution (previous step) <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> form of column vector
<a name="l00556"></a>00556         %&gt; @param alfa relaxation factor (step length)
<a name="l00557"></a>00557         %&gt; @param u    Thikonov regularization factor for matrix pseudo inverse
<a name="l00558"></a>00558         %&gt; @param constrain 'constrain' to limit permittivity value
<a name="l00559"></a>00559         %&gt; @param lt   lower threshold
<a name="l00560"></a>00560         %&gt; @param ut   upper threshold
<a name="l00561"></a>00561         %&gt;
<a name="l00562"></a>00562         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00563"></a>00563         % =====================================================================
<a name="l00564"></a>00564         function Ep = <a class="code" href="alg___newton_ra___limit_8m.html#9df9122c11556ea258de56170cd64ea4" title="alg_NewtonRa_Limit calculates one step of Newton Raphson iteration with constrain...">alg_NewtonRa_Limit</a>(rec_obj,S,Cr,Cm,Ep,alfa,u,constrain,lt,ut)
<a name="l00565"></a>00565         Ep = <a class="code" href="alg___newton_ra___limit_8m.html#9df9122c11556ea258de56170cd64ea4" title="alg_NewtonRa_Limit calculates one step of Newton Raphson iteration with constrain...">alg_NewtonRa_Limit</a>(rec_obj,S,Cr,Cm,Ep,alfa,u,constrain,lt,ut);
<a name="l00566"></a>00566         
<a name="l00567"></a>00567         % =====================================================================
<a name="l00568"></a>00568         %&gt; @brief <a class="code" href="alg___landweber_8m.html#f86e45a13bee5bbfda28deffca46429a" title="alg_Landweber calculates one step of Landweber iteration">alg_Landweber</a> calculates one step of Landweber iteration
<a name="l00569"></a>00569         %&gt;
<a name="l00570"></a>00570         %&gt; @param S    sensitivity matrix
<a name="l00571"></a>00571         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00572"></a>00572         %&gt; @param Cm   vector of measured capacitances
<a name="l00573"></a>00573         %&gt; @param Ep   current estimation of permittivity distribution (previous step) <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> form of column vector
<a name="l00574"></a>00574         %&gt; @param alfa relaxation factor (step length)
<a name="l00575"></a>00575         %&gt;
<a name="l00576"></a>00576         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00577"></a>00577         % =====================================================================
<a name="l00578"></a>00578         function Ep = <a class="code" href="alg___landweber_8m.html#f86e45a13bee5bbfda28deffca46429a" title="alg_Landweber calculates one step of Landweber iteration">alg_Landweber</a>(rec_obj,S,Cr,Cm,Ep,alfa)
<a name="l00579"></a>00579         Ep = <a class="code" href="alg___landweber_8m.html#f86e45a13bee5bbfda28deffca46429a" title="alg_Landweber calculates one step of Landweber iteration">alg_Landweber</a>(rec_obj,S,Cr,Cm,Ep,alfa);
<a name="l00580"></a>00580         
<a name="l00581"></a>00581         % =====================================================================
<a name="l00582"></a>00582         %&gt; @brief <a class="code" href="alg___landweber___norm_8m.html#9e921fcc001b84066c434c855e06f294" title="alg_Landweber_Norm calculates one step of modified Landweber iteration with normalized...">alg_Landweber_Norm</a> calculates one step of modified Landweber iteration
<a name="l00583"></a>00583         %&gt;        with normalized transpose of S matrix
<a name="l00584"></a>00584         %&gt;
<a name="l00585"></a>00585         %&gt; @param S    sensitivity matrix
<a name="l00586"></a>00586         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00587"></a>00587         %&gt; @param Cm   vector of measured capacitances
<a name="l00588"></a>00588         %&gt; @param Ep   current estimation of permittivity distribution (previous step) <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> form of column vector
<a name="l00589"></a>00589         %&gt; @param alfa relaxation factor (step length)
<a name="l00590"></a>00590         %&gt;
<a name="l00591"></a>00591         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00592"></a>00592         % =====================================================================
<a name="l00593"></a>00593         function Ep = <a class="code" href="alg___landweber___norm_8m.html#9e921fcc001b84066c434c855e06f294" title="alg_Landweber_Norm calculates one step of modified Landweber iteration with normalized...">alg_Landweber_Norm</a>(rec_obj,S,Cr,Cm,Ep,alfa)
<a name="l00594"></a>00594         Ep = <a class="code" href="alg___landweber___norm_8m.html#9e921fcc001b84066c434c855e06f294" title="alg_Landweber_Norm calculates one step of modified Landweber iteration with normalized...">alg_Landweber_Norm</a>(rec_obj,S,Cr,Cm,Ep,alfa);
<a name="l00595"></a>00595         
<a name="l00596"></a>00596         % =====================================================================
<a name="l00597"></a>00597         %&gt; @brief <a class="code" href="alg___leven_marq___limit_8m.html#bc4beea8f7a9a29a101c7a7e3142fcdc" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration with constrain...">alg_LevenMarq_Limit</a> calculates one step of Levenberg Marquard iteration
<a name="l00598"></a>00598         %&gt; with constrain for permittivity value, that is not less than 1
<a name="l00599"></a>00599         %&gt;
<a name="l00600"></a>00600         %&gt; @param S    sensitivity matrix
<a name="l00601"></a>00601         %&gt; @param Cr   vector of capacitances to be measured for current estimation of Ep
<a name="l00602"></a>00602         %&gt; @param Cm   vector of measured capacitances
<a name="l00603"></a>00603         %&gt; @param Ep   current estimation of permittivity distribution (previous step) <a class="code" href="display_8m.html#cc8495a7ff254bc8ca37354356abd9fe">in</a> form of column vector
<a name="l00604"></a>00604         %&gt; @param Ep_  previous estimation of permittivity distribution 
<a name="l00605"></a>00605         %&gt; @param alfa relaxation factor (step length)
<a name="l00606"></a>00606         %&gt; @param beta acceleration
<a name="l00607"></a>00607         %&gt; @param u    Thikonov regularization factor for matrix pseudo inverse
<a name="l00608"></a>00608         %&gt; @param constrain 'constrain' to limit permittivity value
<a name="l00609"></a>00609         %&gt; @param lt   lower threshold
<a name="l00610"></a>00610         %&gt; @param ut   upper threshold
<a name="l00611"></a>00611         %&gt;
<a name="l00612"></a>00612         %&gt; @retval Ep (column vector) new better estimation of permittivity 
<a name="l00613"></a>00613         % =====================================================================
<a name="l00614"></a>00614         function Ep = <a class="code" href="alg___leven_marq___limit3_8m.html#c474df8a9a37129baf3dbefd6c821f2f" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration">alg_LevenMarq_Limit3</a>(rec_obj,S,Cr,Cm,Ep,Ep_,alfa,beta,u,constrain,lt,ut)
<a name="l00615"></a>00615         Ep = <a class="code" href="alg___leven_marq___limit3_8m.html#c474df8a9a37129baf3dbefd6c821f2f" title="alg_LevenMarq_Limit calculates one step of Levenberg Marquard iteration">alg_LevenMarq_Limit3</a>(rec_obj,S,Cr,Cm,Ep,Ep_,alfa,beta,u,constrain,lt,ut)
<a name="l00616"></a>00616         
<a name="l00617"></a>00617         % =====================================================================
<a name="l00618"></a>00618         %&gt; @brief <a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a> plots lines with markers better than original one
<a name="l00619"></a>00619         %&gt;
<a name="l00620"></a>00620         %&gt; @param vector values to plot (vector)
<a name="l00621"></a>00621         %&gt; @param line    line color and shape
<a name="l00622"></a>00622         %&gt; @param marker  marker color and shape
<a name="l00623"></a>00623         %&gt; @retval out return value of this method
<a name="l00624"></a>00624         % =====================================================================
<a name="l00625"></a>00625         function[] = <a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a>(rec_obj,vector, line, marker)
<a name="l00626"></a>00626         [] = <a class="code" href="xplot_8m.html#22a52bcea0cfe0f238eca6cc8be027ae" title="xplot plots lines with markers better than original one">xplot</a>(rec_obj,vector, line, marker);
<a name="l00627"></a>00627         
<a name="l00628"></a>00628         % =====================================================================
<a name="l00629"></a>00629         %&gt; @brief <a class="code" href="draw__map_8m.html#2df450806916b45e48786089b4457e8e" title="draw_map draws image">draw_map</a> draws image
<a name="l00630"></a>00630         %&gt;
<a name="l00631"></a>00631         %&gt; @param figno figure number
<a name="l00632"></a>00632         %&gt; @param name  figure name
<a name="l00633"></a>00633         %&gt; @param lt    lower threshold
<a name="l00634"></a>00634         %&gt; @param ut    upper threshold
<a name="l00635"></a>00635         %&gt; @param map   map to <a class="code" href="display_8m.html#5b77131cc4d70e97cbcacda19d91e0a1" title="Overload matlabs function use to display.">display</a>
<a name="l00636"></a>00636         %&gt;
<a name="l00637"></a>00637         %&gt; @retval res  <a class="code" href="display_8m.html#5b77131cc4d70e97cbcacda19d91e0a1" title="Overload matlabs function use to display.">display</a> map
<a name="l00638"></a>00638         % =====================================================================
<a name="l00639"></a>00639         function [res]=<a class="code" href="draw__map_8m.html#2df450806916b45e48786089b4457e8e" title="draw_map draws image">draw_map</a>(rec_obj,figno,name,lt,ut,map)
<a name="l00640"></a>00640         [res]=<a class="code" href="draw__map_8m.html#2df450806916b45e48786089b4457e8e" title="draw_map draws image">draw_map</a>(rec_obj,figno,name,lt,ut,mask,flag,map);
<a name="l00641"></a>00641         
<a name="l00642"></a>00642     end % private methods
<a name="l00643"></a>00643     
<a name="l00644"></a>00644 end
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
